### 计算机网络

- TCP

![img](https://img-blog.csdn.net/20180514183822983?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3plbmdyZW55dWFu/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)





![img](https://img-blog.csdnimg.cn/2021010409370574.gif)



- 物理层：负责物理层级的网络连接，可以通过高低电平来传输比特流。
- 链路层：通过mac地址，可以让网络上的2台设备进行通讯，将比特流转化成帧。通过ARP和RARP协议可以解决mac地址和ip地址的互换，给网络层的协议提供支持。
- 网络层：通过路由选择算法，为报文或分组通过通信子网选择最适当的路径。控制数据链路层与传输层之间的信息转发，建立、维持和终止网络的连接。让连在网络上的设备能高效的通讯。
- 传输层：下面3层的任务主要是为了能高效联通通讯。上面3层主要是为了数据处理，传输层主要是承上启下。向用户提供可靠的端到端的差错和流量控制，保证报文的正确传输。传输层的作用是向高层屏蔽下层数据通信的细节，即向用户透明地传送报文。
  - 传输连接管理：提供建立、维护和拆除传输连接的功能。
  - 处理传输错误：提供可靠的“面向连接”和不太可靠的“面向无连接”的数据传输服务、差错控制和流量控制。这一层传输的数据将由目标设备确认，如果在指定的时间内未收到确认信息，数据将被重发。
- 会话层：用户应用程序和网络之间的接口。向两个实体的表示层提供建立和使用连接的方法，这样的链接为会话。半双工、单工和全双工的方式建立会话。
  - 会话管理：允许用户在两个实体设备之间建立、维持和终止会话，并支持它们之间的数据交换。
  - 会话流量控制：提供会话流量控制和交叉会话功能。
  - 寻址：使用远程地址建立会话连接。
  - 出错控制：从逻辑上讲会话层主要负责数据交换的建立、保持和终止，但实际的工作却是接收来自传输层的数据，并负责纠正错误。
- 表示层：它对来自应用层的命令和数据进行解释，对各种语法赋予相应的含义，并按照一定的格式传送给会话层。
  - 数据格式处理
  - 数据的编码
  - 压缩和解压缩
  - 数据的加密和解密
- 应用层：以及各种应用程序和网络之间的接口，其功能是直接向用户提供服务，完成用户希望在网络上完成的各种工作。协议如http,ftp,email等等
  - 用户接口：应用层是用户与网络，以及应用程序与网络间的直接接口，使得用户能够与网络进行交互式联系。
  - 实现各种服务：该层具有的各种应用程序可以完成和实现用户请求的各种服务。



TCP和UDP的区别

![f0e779df4786eb9e82b1f3326ab81289.png](https://img-blog.csdnimg.cn/img_convert/f0e779df4786eb9e82b1f3326ab81289.png)



这张图对TCP协议与UDP协议的区别作了较为全面的总结。

我们逐一来看。

- TCP协议是**面向连接**的，在之前的文章中曾经提到过，TCP协议需要在通信伊始建立连接，在通信结束断开连接，这分别需要三次握手和四次挥手。对TCP协议的三次握手和四次挥手感兴趣的小伙伴，请看这篇详解TCP的三次握手和四次挥手。而UDP协议则是**非面向连接**的，它不需要三次握手和四次挥手。

- TCP协议是**可靠**的，它的传输可靠性主要通过七点措施来保证。这七点措施分别是连接管理，校验和，序列号，确认应答，超时重传，流量控制，拥塞控制。对TCP协议如何保证传输可靠性感兴趣的小伙伴，请看这篇一探究竟！TCP协议如何保证传输可靠性？而UDP协议则是**不可靠**的。

- TCP协议传输的是**字节流**，UDP协议传输的是**数据报文段**。

- TCP协议保证可靠性意味着需要付出额外的时间和空间代价，因此，TCP的传输效率相对较**低**，UDP传输效率相对较**高**。

- 同理，TCP协议所需资源**多**，UDP协议所需资源**少**。

- TCP首部长度为**20-60字节**。其中，前20字节是固定的，后面4N字节是根据需要而增加的选项，最大为40字节。而UDP首部固定为**8字节**。

- 综上所述，TCP协议适用于**对可靠性要求比较高**的场景，而UDP协议适用于**对传输速度要求比较高**的场景。

TCP（Transmission Control Protocol，传输控制协议）是面向连接的协议，也就是说，在收发数据前，必须和对方建立可靠的连接。 一个TCP连接必须要经过三次“对话”才能建立起来，其中的过程非常复杂， 只简单的描述下这三次对话的简单过程：

1、基于连接与无连接；

2、对系统资源的要求（TCP较多，UDP少）；

3、UDP程序结构较简单；

4、流模式与数据报模式 ；

5、TCP保证数据正确性，UDP可能丢包；

6、TCP保证数据顺序，UDP不保证。











参考资料：

- HTTP三次握手 四次挥手 https://blog.csdn.net/zengrenyuan/article/details/80313449
- HTTP三次握手 四次挥手 https://www.cnblogs.com/guchengnan/p/12160597.html
- 为什么需要等待2MSL https://blog.csdn.net/benjiazhen/article/details/53187568
- netty逻辑处理：https://www.processon.com/view/6073a6c45653bb5a001ff5ab#map
- NIO https://lishaojie1993.gitee.io/2020/04/03/nio/
- 代码模拟 ：https://www.cnblogs.com/ljl150/p/12642726.html
- 7层结构 https://blog.csdn.net/yaopeng_2005/article/details/7064869